{
    "contents" : "#read data \n##downloaded from US Census\ndownload.file(url = \"http://www.census.gov/housing/hvs/data/histtab16.xlsx\",\n              destfile = \"rawdata/homeownership_rates.xlsx\")\n#coerce .xlsx into .csv\n#read csv\nhome_rates <- read.csv(\"rawdata/homeownership_rates_csv.csv\", header=FALSE)\n\n#re-name columns \nlibrary(\"stringr\")\nlibrary(plyr)\nnames(home_rates)[names(home_rates)==\"V1\"] <- \"Year and Quarter\"\nnames(home_rates)[names(home_rates)==\"V2\"] <- \"US Total\"\nnames(home_rates)[names(home_rates)==\"V3\"] <- \"White\"\nnames(home_rates)[names(home_rates)==\"V4\"] <- \"Black\"\nnames(home_rates)[names(home_rates)==\"V5\"] <- \"Other\"\nnames(home_rates)[names(home_rates)==\"V6\"] <- \"Hispanic\"\n\n\n#remove unnecessary columns after \"Hispanic\" with \"NA\"s\nhome_rates$V7 <- NULL\nhome_rates$V8 <- NULL\nhome_rates$V9 <- NULL\nhome_rates$V10 <- NULL\nhome_rates$V11 <- NULL\nhome_rates$V12 <- NULL\n\n\n#remove unnecessary rows in header and footer along \n# with data for 2015 due to incomplete data\n#(missing data for fourth quarter)\nhome_rates <- home_rates[-c(134:155),]\n\n\nhome_rates <- home_rates[-c(1:8),]\n\n\n#remove empty rows in between data for each year\nhome_rates <- home_rates[!apply(is.na(home_rates) | \n                                  home_rates == \"\", 1, all), ]\n\n\n\n#make new column for year to have separate columns for year and quarter\nhome_rates$Year <- rep(1994:2014, each = 5)\n\n#remove 'nth' rows that contain the years, under \"Year and Quarter\" \nindex <- seq(1, nrow(home_rates), by=5)\nhome_rates <- home_rates[-index,]\n\n\n#remove \"Year and Quarter\" column and make \"Quarter\" column\nhome_rates$Quarter <- str_extract(home_rates$`Year and Quarter`, \n                                  pattern = \"^[1-4]\")\nhome_rates$`Year and Quarter` <- NULL            \n\n\n#re-order columns to move \"Year\" and \"Quarter\" and \"\n#Other\" columns to conclude cleaning\nhome_rates <- home_rates[,c(\"Year\", \"Quarter\", \"US Total\", \"White\", \n                            \"Black\", \"Hispanic\", \"Other\")]\nsave(home_rates, file = \"data/home_rates.RData\")\n\n#create average of homeownership rates of all \n#quarters to obtain 1 value for each year for all\n#population groups\n\naverage_black_rate <- calc_black_rate()\n\n#average White homeownership rate by year\naverage_white_rate <- calc_white_rate()\n\n#average Hispanic homeownership rate by year\naverage_hispanic_rate <- calc_hispanic_rate()\n\n#average Other homeownership rate by year\naverage_other_rate <- calc_other_rate()\n\n#average total US homeownership rate by year\naverage_US_rate <- calc_US_rate()\n\n#compare minority group averages with US Total average \npdf(\"plots/rates_comparison.pdf\")\npng(\"plots/rates_comparison.png\")\nplot.new()\nplot(unique(home_rates$Year), average_US_rate, xlab = \"Year\", \n     main = \"Average Homeownership Rates: Minority Groups vs. US Total\", \n     ylab = \"Homeownership Rates\", xaxt = 'n', lwd = 3, \n     yaxt = 'n', type = \"l\", col = \"#FF4040\", \n     axes = FALSE, ylim= c(40,80), xlim = c(1994, 2014))\nlines(unique(home_rates$Year), average_hispanic_rate, \n      xaxt = 'n', yaxt = 'n', lwd = 3, col = \"#7FFFD4\")\nlines(unique(home_rates$Year), average_black_rate, \n      xaxt = 'n', yaxt = 'n', lwd = 3, col = \"#FF7F50\")\naxis(side = 2, at = c(seq(from = 40, to = 80, by = 5)), las = 1)\naxis(side = 1, at = c(seq(from = 1994, to = 2014, by = 2)), las = 2)\nabline(h = c(seq(from=40,to=80,by=5)), \n       v = c(seq(from = 1994, to = 2014, by = 2)))\nlegend(\"topright\", title = \"Homeownership Rates\", \n       col = c(\"#FF4040\", \"#7FFFD4\", \"#FF7F50\"), \n       legend = c(\"Total US\", \"Hispanic\", \"Black\"), \n       lwd = c(2.5, 2.5), lty = c(1,1), cex = 0.7)\ndev.off()\n\n#create plot demonstrating change in differences in \n#homeownership rates for hispanic vs US total\ndiff_hisp <- c()\nfor (i in 1994:2014) {\n  result = calc_diff(average_US_rate, average_hispanic_rate)\n}\ndiff_hisp <- c(diff_hisp, result)\npdf(\"plots/differences_hispanic.pdf\")\npng(\"plots/differences_hispanic.png\")\n\nplot.new()\nplot(unique(home_rates$Year), diff_hisp, \n     main = \"Difference in Avg US and Hispanic Homeownership Rates\", \n     ylim = c(10,30), type = 'l', lwd = 4, col = \"#8B0000\",\n     xlab = \"Year\", ylab = \"Homeownership Rates\")\nabline(h = c(seq(from=10,to=30,by=5)), \n       v = c(seq(from = 1994, to = 2014, by = 2)))\ndev.off()\n\n#create vector of differences in homeownership rates for US total vs Black\ndiff_black <- c()\nfor (i in 1994:2014) {\n  result = calc_diff(average_US_rate, average_black_rate)\n}\ndiff_black <- c(diff_black, result)\n\n#create plot demonstrating change in differences in homeownership rates \n#for black vs US total\npdf(\"plots/differences_black.pdf\")\npng(\"plots/differences_black.png\")\nplot.new()\nplot(unique(home_rates$Year), diff_black, \n     main = \"Difference in Avg US and Black Homeownership Rates\", \n     ylim = c(10,30), type = 'l', lwd = 4, col = \"#0000EE\",\n     xlab = \"Year\", ylab = \"Homeownership Rates\")\nabline(h = c(seq(from=10,to=30,by=5)), \n       v = c(seq(from = 1994, to = 2014, by = 2)))\ndev.off()\n\n#create vector of differences in homeownership rates for US total vs other\ndiff_other <- c()\nfor (i in 1994:2014) {\n  result = calc_diff(average_US_rate, average_other_rate)\n}\ndiff_other <- c(diff_other, result)\n\n#create plot demonstrating change in differences in \n#homeownership rates for other vs US total\npdf(\"plots/differences_other.pdf\")\npng(\"plots/differences_other.png\")\nplot.new()\nplot(unique(home_rates$Year), diff_other, \n     main = \"Difference in Avg US and 'Other' Homeownership Rates\", \n     ylim = c(0,30), type = 'l', lwd = 4, col = \"#76EEC6\",\n     xlab = \"Year\", ylab = \"Homeownership Rates\", las = 1)\nabline(h = c(seq(from=0,to=30,by=5)), \n       v = c(seq(from = 1994, to = 2014, by = 2)))\ndev.off()\n\n",
    "created" : 1450155338271.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "2133905886",
    "id" : "4E408658",
    "lastKnownWriteTime" : 1450155526,
    "path" : "~/SCHOOL/Fall 2015/STATS 133 - COMPUTING W DATA/133 R wd/Final/code/homeownership_rates.R",
    "project_path" : "code/homeownership_rates.R",
    "properties" : {
    },
    "relative_order" : 1,
    "source_on_save" : false,
    "type" : "r_source"
}